---















- name: Configure private aliases
  become: true
  blockinfile:
    state: present
    insertafter: EOF
    dest: /etc/sysctl.conf
    marker_begin: "begin CUSTOM ansible marker"
    marker_end: "end CUSTOM ansible marker"
    content: |
      vm.overcommit_memory = 1

- name: Enable thp globally
  become: true
  command: echo never > /sys/kernel/mm/transparent_hugepage/enabled

- name: Configure private aliases
  blockinfile:
    state: present
    insertafter: EOF
    dest: ~/.bashrc
    marker_begin: "begin CUSTOM BASHRC ansible marker"
    marker_end: "end CUSTOM BASHRC ansible marker"
    content: |
      alias ..="cd .."
      alias cat='bat'              # cat is now bat
      alias l='exa'
      alias ll='exa -lah'

- name: Shutdown WSL (to restart WSL)
  when: "not wsl_conf_is_installed.stat.exists"
  command: wsl.exe --shutdown
  tags:
    - wsl